<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Carrito de Compras</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="clearCart()" *ngIf="cartItems.length > 0">
        <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Carrito vacío -->
  <div *ngIf="cartItems.length === 0" class="empty-cart">
    <ion-icon name="cart-outline"></ion-icon>
    <h2>Tu carrito está vacío</h2>
    <p>Agrega algunos productos para continuar</p>
    <ion-button routerLink="/home" fill="solid">
      <ion-icon slot="start" name="storefront-outline"></ion-icon>
      Ir de Compras
    </ion-button>
  </div>

  <!-- Carrito con items -->
  <div *ngIf="cartItems.length > 0">
    <!-- Lista de productos -->
    <ion-list>
      <ion-item *ngFor="let item of cartItems" class="cart-item">
        <ion-thumbnail slot="start">
          <img [src]="item.imageUrl" [alt]="item.name" (error)="item.imageUrl = 'assets/images/placeholder.jpg'" />
        </ion-thumbnail>
        
        <ion-label class="item-info">
          <h3>{{ item.name }}</h3>
          <p class="item-brand">{{ item.brandName }} - {{ item.sizeMl }}ml</p>
          <p class="item-price">{{ item.price | currency:'USD':'symbol':'1.2-2' }}</p>
        </ion-label>

        <!-- Selector de cantidad -->
        <ion-buttons slot="end" class="quantity-controls">
          <ion-button (click)="decreaseQuantity(item)" [disabled]="item.quantity <= 1">
            <ion-icon name="remove-outline"></ion-icon>
          </ion-button>
          <ion-text class="quantity">{{ item.quantity }}</ion-text>
          <ion-button (click)="increaseQuantity(item)">
            <ion-icon name="add-outline"></ion-icon>
          </ion-button>
        </ion-buttons>

        <!-- Botón eliminar -->
        <ion-button slot="end" fill="clear" color="danger" (click)="removeItem(item)">
          <ion-icon name="close-outline"></ion-icon>
        </ion-button>
      </ion-item>
    </ion-list>

    <!-- Resumen del pedido -->
    <ion-card class="summary-card">
      <ion-card-header>
        <ion-card-title>Resumen del Pedido</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="summary-row">
          <span>Subtotal ({{ getTotalItems() }} items):</span>
          <span>{{ subtotal | currency:'USD':'symbol':'1.2-2' }}</span>
        </div>
        <div class="summary-row">
          <span>Envío:</span>
          <span>{{ shipping | currency:'USD':'symbol':'1.2-2' }}</span>
        </div>
        <div class="summary-row">
          <span>IVA (16%):</span>
          <span>{{ tax | currency:'USD':'symbol':'1.2-2' }}</span>
        </div>
        <div class="summary-row total">
          <span><strong>Total:</strong></span>
          <span><strong>{{ total | currency:'USD':'symbol':'1.2-2' }}</strong></span>
        </div>

        <!-- Botón de checkout -->
        <ion-button 
          expand="block" 
          size="large" 
          routerLink="/checkout"
          class="checkout-btn">
          <ion-icon slot="start" name="bag-check-outline"></ion-icon>
          Proceder al Pago
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>